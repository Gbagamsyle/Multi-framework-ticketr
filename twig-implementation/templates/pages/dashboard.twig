{% extends "base.twig" %}

{% block title %}Dashboard - TicketApp{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="/css/styles/dashboard.css">
{% endblock %}

{% block content %}
<div class="dashboard">
    {# Header #}
    <header class="page-header">
        <div class="flex items-center gap-4">
            <div class="avatar">{{ user.email|first|upper }}</div>
            <div>
                <h1 class="page-title">Welcome back, {{ user.email }}</h1>
                <p class="page-description">Here's an overview of your support tickets</p>
            </div>
        </div>
        <a href="/tickets" class="button primary">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                <path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
            </svg>
            Create Ticket
        </a>
    </header>

    {# Stats Section #}
    <section class="section">
        <h2 class="section-title">Overview</h2>
        <div class="grid-4">
            {# Total Tickets #}
            <div class="stats-card" style="background: linear-gradient(135deg, #6366f1 0%, #4338ca 100%)">
                <div>
                    <span class="stats-value">{{ stats.total_tickets }}</span>
                    <span class="stats-label">Total Tickets</span>
                </div>
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="currentColor" d="M21 3h-6.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H3v18h18V3zm-9 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" />
                </svg>
            </div>

            {# Open Tickets #}
            <div class="stats-card" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%)">
                <div>
                    <span class="stats-value">{{ stats.open_tickets }}</span>
                    <span class="stats-label">Open</span>
                </div>
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="currentColor" d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z" />
                </svg>
            </div>

            {# In Progress Tickets #}
            <div class="stats-card" style="background: linear-gradient(135deg, #eab308 0%, #ca8a04 100%)">
                <div>
                    <span class="stats-value">{{ stats.in_progress_tickets }}</span>
                    <span class="stats-label">In Progress</span>
                </div>
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z" />
                </svg>
            </div>

            {# Closed Tickets #}
            <div class="stats-card" style="background: linear-gradient(135deg, #475569 0%, #334155 100%)">
                <div>
                    <span class="stats-value">{{ stats.closed_tickets }}</span>
                    <span class="stats-label">Resolved</span>
                </div>
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="currentColor" d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" />
                </svg>
            </div>
        </div>
    </section>

    {# Quick Actions Section #}
    <section class="section">
        <h2 class="section-title">Quick Actions</h2>

        <div class="card card-full">
            <div class="card-header">
                <h3 class="card-title">Manage Tickets</h3>
                <a href="/tickets" class="button button-secondary">View All</a>
            </div>
            <p>Access and update your support tickets from one place.</p>
            <div class="flex gap-4 mt-4">
                <div class="tag">Open Issues: {{ stats.open_tickets }}</div>
                <div class="tag">In Progress: {{ stats.in_progress_tickets }}</div>
            </div>
        </div>

        {% if stats.high_priority_tickets > 0 %}
            <div class="card card-full" style="border-color: var(--color-error); border-width: 2px; margin-top: 1.5rem">
                <div class="card-header">
                    <h3 class="card-title">High Priority</h3>
                    <div class="priority high">{{ stats.high_priority_tickets }} Active</div>
                </div>
                <p>These tickets require immediate attention.</p>
                <a href="/tickets?priority=high" class="button" style="margin-top: 1rem; background-color: var(--color-error)">
                    View High Priority
                </a>
            </div>
        {% endif %}
    </section>
</div>
{% endblock %}